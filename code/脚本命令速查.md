# 脚本命令速查表

## 🚀 启动服务

### 启动所有服务
```bash
pnpm run start:all
```

### 启动单个服务
```bash
pnpm run start:gateway      # API网关 (7001)
pnpm run start:auth         # 认证服务 (7000)
pnpm run start:customer     # 客户服务 (7002)
pnpm run start:acquisition  # 获客服务 (7003)
pnpm run start:operation    # 运营服务 (7004)
pnpm run start:asset        # 素材服务 (7005)
pnpm run start:message      # 消息服务 (7006)
pnpm run start:integration  # 集成服务 (7007)
pnpm run start:analytics    # 分析服务 (7008)
pnpm run start:finance      # 财务服务 (7009)
```

## 🛑 停止服务

### 停止所有服务
```bash
pnpm run stop:all
```

### 停止单个服务
- 关闭服务窗口，或在窗口中按 `Ctrl+C`

## 🔍 检查状态

### 检查所有服务状态
```bash
pnpm run check:services
```

### 检查单个服务
```bash
# 访问健康检查接口
curl http://localhost:7001/health  # 网关
curl http://localhost:7000/health  # 认证
# ... 其他服务
```

## 🧪 测试命令

### 完整测试（编译 + 类型检查）
```bash
pnpm run test
```

### 仅编译测试
```bash
pnpm run test:build
```

### 仅类型检查
```bash
pnpm run test:type
```

### 生成测试报告
```bash
pnpm run test:report
```

### 详细输出测试
```bash
pnpm run test:verbose
```

## 📦 项目管理

### 安装依赖
```bash
pnpm install
```

### 构建所有服务
```bash
pnpm run build
```

### 代码格式化
```bash
pnpm run format
```

### 代码检查
```bash
pnpm run lint
```

### 类型检查
```bash
pnpm run type-check
```

### 清理项目
```bash
pnpm run clean
```

## 🎯 常用组合

### 开发客户管理功能
```bash
pnpm run start:gateway     # 先启动网关
pnpm run start:auth        # 再启动认证
pnpm run start:customer    # 最后启动客户服务
```

### 开发运营功能（SOP/群发）
```bash
pnpm run start:gateway
pnpm run start:auth
pnpm run start:customer
pnpm run start:operation
pnpm run start:message
```

### 开发获客功能
```bash
pnpm run start:gateway
pnpm run start:auth
pnpm run start:acquisition
pnpm run start:integration
```

### 开发财务功能
```bash
pnpm run start:gateway
pnpm run start:auth
pnpm run start:finance
```

## 💾 数据库管理

### 初始化数据库
```bash
mysql -u root -p < scripts/init-db.sql
```

### 启动 Docker 服务
```bash
docker-compose up -d
```

### 停止 Docker 服务
```bash
docker-compose down
```

## 🔧 直接执行脚本

### Windows PowerShell
```powershell
.\scripts\run\start-all-services.ps1
.\scripts\run\stop-all-services.ps1
.\scripts\run\check-services.ps1
.\scripts\run\start-gateway.ps1
.\scripts\run\start-auth.ps1
# ... 其他启动脚本
```

## 📊 服务端口对照表

| 服务 | 端口 | 启动命令 |
|------|------|----------|
| 认证服务 | 7000 | `pnpm run start:auth` |
| API网关 | 7001 | `pnpm run start:gateway` |
| 客户服务 | 7002 | `pnpm run start:customer` |
| 获客服务 | 7003 | `pnpm run start:acquisition` |
| 运营服务 | 7004 | `pnpm run start:operation` |
| 素材服务 | 7005 | `pnpm run start:asset` |
| 消息服务 | 7006 | `pnpm run start:message` |
| 集成服务 | 7007 | `pnpm run start:integration` |
| 分析服务 | 7008 | `pnpm run start:analytics` |
| 财务服务 | 7009 | `pnpm run start:finance` |

## 📝 快速开发流程

```bash
# 1. 启动依赖服务
docker-compose up -d

# 2. 启动需要的微服务
pnpm run start:gateway
pnpm run start:auth
pnpm run start:customer

# 3. 开发代码...

# 4. 运行测试
pnpm run test

# 5. 停止服务
pnpm run stop:all
# 或关闭服务窗口
```

## 🆘 故障排查

### 端口被占用
```bash
# 检查端口占用
netstat -ano | findstr "7001"

# 停止所有服务
pnpm run stop:all
```

### 服务启动失败
```bash
# 检查配置
# 1. 确认 .env 文件存在
# 2. 确认数据库已启动
# 3. 确认 Redis 已启动

# 检查服务状态
pnpm run check:services
```

### 依赖问题
```bash
# 重新安装依赖
rm -rf node_modules
pnpm install
```

## 🔗 相关文档

- [脚本总览](./scripts/README.md)
- [运行脚本文档](./scripts/run/README.md)
- [测试脚本文档](./scripts/test/README.md)
- [环境配置说明](./环境配置说明.md)
- [测试文档](./TESTING.md)
- [快速开始](./快速开始.md)

